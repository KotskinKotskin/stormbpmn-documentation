---
dir:
    name: "1. Схема архитектуры"
    order: 1
    link: true
index: true

order: 1
---

# 1. Схема архитектуры

Если использовать все возможности системы, то компонентная архитектура будет выглядеть так [ссылка.](https://stormbpmn.com/app/plant/f3af4a00-b1dd-4666-ad10-82f89705c74e)

## Архитектура StormBPMN

### Основной компонент

-   **Приложение StormBPMN**  
    Центральное веб-приложение, поставляемое командой StormBPMN. Отвечает за моделирование, хранение и управление бизнес-процессами.

---

### Используемая инфраструктура (на стороне заказчика)

#### Инфраструктурные компоненты

| Компонент                                             | Назначение                                 |
| ----------------------------------------------------- | ------------------------------------------ |
| **Балансировщик нагрузки (рекомендуем nginx)**        | Обеспечивает HTTPS, распределение трафика  |
| **База данных (PostgreSQL 12+)**                      | Хранение всей информации                   |
| **Хранилище файлов (MinIO или любой S3-совместимый)** | Хранение документов, превью, вложений      |
| **SMTP-сервер (внутренний)**                          | Отправка писем                             |
| **Keycloak / OAuth2 / LDAP**                          | Используются для авторизации пользователей |
| **Log Collector (например, Syslog)**                  | Сбор логов безопасности                    |
| **Prometheus**                                        | Сбор метрик                                |
| **Grafana**                                           | Визуализация метрик, алерты                |

> **LDAP** помечен как устаревший способ авторизации и не рекомендуется к использованию в новых установках. **Крайне** рекомендуем освоить Keycloak, сильно сэкономите силы и время на поддержку. Инструкции по настройке LDAP предоставляются через менеджера.

---

### Внешние open-source решения

| Компонент     | Назначение                                          |
| ------------- | --------------------------------------------------- |
| **ListMonk**  | Используется при сложной генерации и рассылке писем |
| **PlantUML**  | Генерация UML-диаграмм                              |
| **Gotenberg** | Конвертация изображений и HTML в PDF                |

---

### Пользователи системы

| Тип                  | Описание                                      |
| -------------------- | --------------------------------------------- |
| **Пользователь**     | Работа с процессами и шаблонами               |
| **Администратор**    | Настройка приложений, систем, метрик          |
| **Администратор ИБ** | Настройка логирования и контроля безопасности |

---

### Основные взаимодействия

-   Пользователи и администраторы взаимодействуют с системой через балансировщик по HTTPS.
-   Приложение `stormbpmn`:

    -   сохраняет данные в PostgreSQL;
    -   отправляет и принимает файлы через S3-совместимое хранилище;
    -   отправляет письма через SMTP (или через ListMonk для сложной генерации);
    -   обращается к системам авторизации: Keycloak, OAuth, LDAP;
    -   генерирует диаграммы через PlantUML и PDF-документы через Gotenberg;
    -   отправляет логи в Log Collector;
    -   отдаёт метрики Prometheus.

-   Prometheus собирает метрики с приложения.
-   Grafana отображает метрики и настраивает алерты.

---

### Безопасность

-   Все внешние подключения защищены через HTTPS.
-   Для админов и ИБ доступны SSH-подключения.
-   Устаревший LDAP выделен как компонент, не рекомендуемый к использованию.
